{
  "annotations": {
    "list": [
      {
        "datasource": {"type": "prometheus", "uid": "prometheus"},
        "enable": true,
        "expr": "ALERTS{alertname=\"TradeFailed\"}",
        "iconColor": "red",
        "name": "Trade Failures",
        "titleFormat": "Trade Failed"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [
    {
      "asDropdown": false,
      "icon": "external link",
      "tags": [],
      "targetBlank": true,
      "title": "Overview",
      "url": "/d/jarvis-overview"
    }
  ],
  "liveNow": false,
  "panels": [
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 0},
      "id": 100,
      "panels": [],
      "title": "Portfolio Overview",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "unit": "currencyUSD",
          "thresholds": {
            "mode": "absolute",
            "steps": [{"color": "green", "value": null}]
          }
        }
      },
      "gridPos": {"h": 6, "w": 6, "x": 0, "y": 1},
      "id": 1,
      "options": {"colorMode": "value", "graphMode": "area"},
      "targets": [
        {"expr": "treasury_total_value_usd", "legendFormat": "Total Value"}
      ],
      "title": "Portfolio Value",
      "type": "stat"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "unit": "percentunit",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "red", "value": null},
              {"color": "yellow", "value": 0},
              {"color": "green", "value": 0.01}
            ]
          }
        }
      },
      "gridPos": {"h": 6, "w": 6, "x": 6, "y": 1},
      "id": 2,
      "options": {"colorMode": "value", "graphMode": "area"},
      "targets": [
        {"expr": "treasury_pnl_percent_24h / 100", "legendFormat": "24h P&L %"}
      ],
      "title": "24h P&L %",
      "type": "stat"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {"h": 6, "w": 6, "x": 12, "y": 1},
      "id": 3,
      "options": {"colorMode": "value"},
      "targets": [
        {"expr": "sum(increase(trade_executions_total{status=\"success\"}[24h]))", "legendFormat": "Trades"}
      ],
      "title": "24h Trades",
      "type": "stat"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {"color": "red", "value": null},
              {"color": "yellow", "value": 0.9},
              {"color": "green", "value": 0.95}
            ]
          }
        }
      },
      "gridPos": {"h": 6, "w": 6, "x": 18, "y": 1},
      "id": 4,
      "options": {"colorMode": "value"},
      "targets": [
        {"expr": "sum(increase(trade_executions_total{status=\"success\"}[24h])) / sum(increase(trade_executions_total[24h]))", "legendFormat": "Success Rate"}
      ],
      "title": "Trade Success Rate",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 7},
      "id": 101,
      "panels": [],
      "title": "Portfolio Performance",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "currencyUSD"}
      },
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8},
      "id": 10,
      "targets": [
        {"expr": "treasury_total_value_usd", "legendFormat": "Total Value"}
      ],
      "title": "Portfolio Value Over Time",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "currencyUSD"}
      },
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 8},
      "id": 11,
      "targets": [
        {"expr": "treasury_pnl_cumulative_usd", "legendFormat": "Cumulative P&L"}
      ],
      "title": "Cumulative P&L",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "currencyUSD"}
      },
      "gridPos": {"h": 8, "w": 24, "x": 0, "y": 16},
      "id": 12,
      "options": {
        "legend": {"displayMode": "table", "placement": "right"},
        "pieType": "donut"
      },
      "targets": [
        {"expr": "treasury_token_value_usd", "legendFormat": "{{token}}"}
      ],
      "title": "Portfolio Allocation",
      "type": "piechart"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 24},
      "id": 102,
      "panels": [],
      "title": "Trading Activity",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "short"}
      },
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 25},
      "id": 20,
      "targets": [
        {"expr": "rate(trade_executions_total[5m])", "legendFormat": "{{type}} - {{status}}"}
      ],
      "title": "Trade Execution Rate",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "currencyUSD"}
      },
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 25},
      "id": 21,
      "targets": [
        {"expr": "rate(trade_volume_usd_total[5m]) * 300", "legendFormat": "Volume (5m)"}
      ],
      "title": "Trading Volume",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "gridPos": {"h": 8, "w": 24, "x": 0, "y": 33},
      "id": 22,
      "options": {"showHeader": true, "sortBy": [{"desc": true, "displayName": "Time"}]},
      "targets": [
        {"expr": "trade_history", "format": "table", "instant": true}
      ],
      "title": "Recent Trades",
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 41},
      "id": 103,
      "panels": [],
      "title": "Execution Quality",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "s"}
      },
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 42},
      "id": 30,
      "targets": [
        {"expr": "histogram_quantile(0.50, rate(trade_execution_latency_seconds_bucket[5m]))", "legendFormat": "p50"},
        {"expr": "histogram_quantile(0.95, rate(trade_execution_latency_seconds_bucket[5m]))", "legendFormat": "p95"},
        {"expr": "histogram_quantile(0.99, rate(trade_execution_latency_seconds_bucket[5m]))", "legendFormat": "p99"}
      ],
      "title": "Trade Execution Latency",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "percentunit"}
      },
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 42},
      "id": 31,
      "targets": [
        {"expr": "avg(trade_slippage_percent) / 100", "legendFormat": "Avg Slippage"}
      ],
      "title": "Average Slippage",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 50},
      "id": 104,
      "panels": [],
      "title": "Risk Metrics",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "percentunit"}
      },
      "gridPos": {"h": 6, "w": 6, "x": 0, "y": 51},
      "id": 40,
      "options": {"colorMode": "value"},
      "targets": [
        {"expr": "treasury_drawdown_percent / 100", "legendFormat": "Drawdown"}
      ],
      "title": "Current Drawdown",
      "type": "stat"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "percentunit"}
      },
      "gridPos": {"h": 6, "w": 6, "x": 6, "y": 51},
      "id": 41,
      "options": {"colorMode": "value"},
      "targets": [
        {"expr": "treasury_max_drawdown_percent / 100", "legendFormat": "Max Drawdown"}
      ],
      "title": "Max Drawdown",
      "type": "stat"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "short", "decimals": 2}
      },
      "gridPos": {"h": 6, "w": 6, "x": 12, "y": 51},
      "id": 42,
      "options": {"colorMode": "value"},
      "targets": [
        {"expr": "treasury_sharpe_ratio", "legendFormat": "Sharpe"}
      ],
      "title": "Sharpe Ratio",
      "type": "stat"
    },
    {
      "datasource": {"type": "prometheus", "uid": "prometheus"},
      "fieldConfig": {
        "defaults": {"unit": "percentunit"}
      },
      "gridPos": {"h": 6, "w": 6, "x": 18, "y": 51},
      "id": 43,
      "options": {"colorMode": "value"},
      "targets": [
        {"expr": "treasury_win_rate / 100", "legendFormat": "Win Rate"}
      ],
      "title": "Win Rate",
      "type": "stat"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 38,
  "tags": ["jarvis", "trading", "treasury"],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-24h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "JARVIS - Trading Dashboard",
  "uid": "jarvis-trading",
  "version": 1
}
