---
phase: v2-01-core-trading
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - web/static/index.html
  - web/static/src/App.jsx
  - web/static/src/components/PortfolioHeader.jsx
  - web/static/src/components/PositionsList.jsx
  - web/static/src/components/PositionCard.jsx
  - web/static/src/hooks/useWebSocket.js
  - web/static/src/hooks/useApi.js
  - web/static/src/store.js
  - web/static/package.json
  - web/static/tailwind.config.js
  - web/static/vite.config.js
autonomous: true

must_haves:
  truths:
    - "React app renders portfolio header with balance and P&L"
    - "Position list displays all open positions with P&L color coding"
    - "WebSocket hook connects to Socket.IO and receives price updates"
  artifacts:
    - path: "web/static/src/App.jsx"
      provides: "Main React app with routing and layout"
      min_lines: 30
    - path: "web/static/src/components/PortfolioHeader.jsx"
      provides: "Portfolio balance, P&L, position count display"
      min_lines: 20
    - path: "web/static/src/components/PositionsList.jsx"
      provides: "Sortable position list with P&L"
      min_lines: 40
    - path: "web/static/src/hooks/useWebSocket.js"
      provides: "Socket.IO connection with reconnection"
      min_lines: 20
  key_links:
    - from: "web/static/src/hooks/useApi.js"
      to: "/api/status"
      via: "fetch"
      pattern: "fetch.*api/status"
    - from: "web/static/src/hooks/useWebSocket.js"
      to: "socketio"
      via: "socket.io-client"
      pattern: "io\\("
---

<objective>
Create the React frontend with portfolio dashboard, position list, and WebSocket integration.

Purpose: Build the read-only view layer - portfolio overview and position monitoring with real-time updates.
Output: React app in web/static/ that displays portfolio and positions with live price updates.
</objective>

<execution_context>
@C:\Users\lucid\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\lucid\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/v2-01-core-trading/V2-01-RESEARCH.md
@frontend/src/components/Trading.jsx (reference for component patterns)
@web_demo/frontend/src/ (reference for Zustand patterns)
</context>

<tasks>

<task type="auto">
  <name>Task 1: React app scaffold with Vite + Tailwind</name>
  <files>web/static/package.json, web/static/vite.config.js, web/static/tailwind.config.js, web/static/postcss.config.js, web/static/index.html, web/static/src/main.jsx, web/static/src/index.css</files>
  <action>
  1. Create web/static/ directory for the React app.

  2. Initialize with package.json containing:
     - react 18, react-dom 18
     - socket.io-client 4.x
     - zustand (state management)
     - Dev: vite, @vitejs/plugin-react, tailwindcss, postcss, autoprefixer

  3. vite.config.js:
     - Build output to `dist/` (Flask will serve from here)
     - Proxy `/api` and `/socket.io` to `http://localhost:5001` during dev
     - Dev server on port 3000

  4. tailwind.config.js:
     - Dark mode: 'class'
     - Content: ['./src/**/*.{js,jsx}', './index.html']
     - Extend colors with trading-specific: green-500 for profit, red-500 for loss

  5. index.html: minimal HTML with `<div id="root">`, dark mode class on html element

  6. src/index.css: Tailwind directives (@tailwind base/components/utilities), dark background default (#0f172a)

  7. src/main.jsx: Render App into root

  8. Run `npm install` in web/static/

  IMPORTANT: Use JSX not TypeScript. Keep it simple - this is a trading dashboard, not a component library.
  </action>
  <verify>
  Run `cd "c:\Users\lucid\OneDrive\Desktop\Projects\Jarvis\web\static" && npm run build` succeeds.
  web/static/dist/index.html exists after build.
  </verify>
  <done>
  React + Vite + Tailwind scaffold builds successfully. Dark mode configured. Dev proxy configured for API.
  </done>
</task>

<task type="auto">
  <name>Task 2: Portfolio dashboard and position list components</name>
  <files>web/static/src/App.jsx, web/static/src/store.js, web/static/src/hooks/useApi.js, web/static/src/hooks/useWebSocket.js, web/static/src/components/PortfolioHeader.jsx, web/static/src/components/PositionsList.jsx, web/static/src/components/PositionCard.jsx, web/static/src/components/ConnectionIndicator.jsx</files>
  <action>
  1. src/store.js - Zustand store:
     - `portfolio`: {wallet_address, sol_balance, usd_value, position_count, market_regime}
     - `positions`: array of position objects
     - `prices`: {mint: {price, change_24h}} map
     - `wsConnected`: boolean
     - Actions: setPortfolio, setPositions, updatePrices, setWsConnected

  2. src/hooks/useApi.js:
     - `usePortfolio()` - fetches GET /api/status on mount, updates store, refetches every 30s
     - `usePositions()` - fetches GET /api/positions on mount, updates store, refetches every 30s
     - Base URL: '' (same origin) in production, 'http://localhost:5001' in dev

  3. src/hooks/useWebSocket.js:
     - Connect to Socket.IO on mount (same origin)
     - Listen for `price_update` -> update store prices
     - Listen for `position_update` -> update store positions
     - Listen for `connection_status` -> update store wsConnected
     - Auto-reconnect with exponential backoff (1s, 2s, 4s, max 30s)
     - Emit `subscribe_prices` with position mints when positions change

  4. src/components/PortfolioHeader.jsx:
     - Display: SOL balance (with SOL icon), USD value, total P&L (green if +, red if -)
     - Position count badge
     - Market regime indicator (pill: "Bull" green, "Bear" red, "Neutral" gray)
     - Responsive: stacks on mobile, horizontal on desktop

  5. src/components/PositionsList.jsx:
     - Renders list of PositionCard components
     - Sort buttons: "P&L" | "Recent" | "Size"
     - Empty state: "No open positions" with buy CTA
     - Loading skeleton while fetching

  6. src/components/PositionCard.jsx:
     - Token symbol + truncated mint address
     - Entry price vs current price
     - P&L percentage (green/red with arrow icons)
     - Amount in SOL
     - TP/SL indicators (small pills)
     - Quick sell buttons: 25%, 50%, 100% (just buttons for now, wiring in Plan 03)
     - Compact card design, dark bg-slate-800 with rounded corners

  7. src/components/ConnectionIndicator.jsx:
     - Small dot in top-right: green=connected, yellow=reconnecting, red=disconnected
     - Tooltip with status text

  8. src/App.jsx:
     - Initialize useWebSocket, usePortfolio, usePositions hooks
     - Layout: max-w-6xl mx-auto, padding
     - Header: "Jarvis Trading" + ConnectionIndicator
     - PortfolioHeader
     - PositionsList
     - Placeholder div for buy button (wired in Plan 03)

  Style: Dark mode (bg-slate-900 base), Tailwind utility classes, no external component libraries.
  Responsive: Mobile-first. Grid 1-col on mobile, 2-col on lg for position cards.
  </action>
  <verify>
  Run `cd "c:\Users\lucid\OneDrive\Desktop\Projects\Jarvis\web\static" && npm run build` succeeds without errors.
  All component files exist and contain JSX with Tailwind classes.
  App.jsx imports and renders PortfolioHeader and PositionsList.
  </verify>
  <done>
  Portfolio header shows balance/P&L/regime. Position list renders cards with P&L color coding. WebSocket hook connects and updates prices. Connection indicator shows status. All components render in dark mode with responsive layout.
  </done>
</task>

</tasks>

<verification>
- `npm run build` in web/static/ succeeds
- dist/index.html generated
- All components render without console errors (check build output)
- Zustand store has portfolio, positions, prices, wsConnected
- WebSocket hook has reconnection logic
</verification>

<success_criteria>
- React app builds and produces dist/ output
- Portfolio header displays balance, P&L, position count, regime
- Position list renders cards with P&L color coding
- WebSocket hook connects to Socket.IO backend
- Dark mode, mobile-responsive layout
</success_criteria>

<output>
After completion, create `.planning/phases/v2-01-core-trading/v2-01-02-SUMMARY.md`
</output>
